<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Image2Scale</title>

<link rel="icon" type="image/svg+xml" href="logo.svg">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
:root {
  --accent:#2b6cb0;
  --bg:#f4f6f8;
  --border:#e0e0e0;
  --shadow:0 10px 22px rgba(0,0,0,.1);
}

body {
  margin:0;
  font-family:system-ui;
  background:var(--bg);
}

.main {
  max-width:760px;
  margin:80px auto;
  background:white;
  padding:30px;
  border-radius:14px;
  box-shadow:var(--shadow);
}

.drop {
  border:2px dashed var(--border);
  border-radius:12px;
  padding:30px;
  text-align:center;
  cursor:pointer;
  margin:20px 0;
  transition:border-color .2s, box-shadow .2s, transform .2s;
}
.drop:hover {
  border-color:var(--accent);
  box-shadow:0 0 0 4px rgba(43,108,176,.12);
  transform:translateY(-2px);
}

label { font-size:14px;color:#444; }
select, button {
  padding:10px 14px;
  border-radius:8px;
  border:1px solid var(--border);
}
button {
  background:var(--accent);
  color:white;
  border:none;
  width:auto;
  transition:transform .15s, box-shadow .15s;
}
button:hover {
  transform:translateY(-2px) scale(.98);
  box-shadow:var(--shadow);
}
</style>
</head>

<body>
<div class="main">

<h1>Image2Scale</h1>

<div class="drop" id="drop">
  <strong>Drop one image</strong>
  <input type="file" id="file" hidden accept="image/*">
</div>

<label>Have</label>
<select id="from"><option>A4</option><option>A3</option><option>A2</option></select>

<label>Want</label>
<select id="to"><option>A4</option><option>A3</option><option>A2</option></select>

<div style="margin-top:30px">
  <button onclick="exportPDF()">
    <i class="fa-solid fa-file-pdf"></i> Export PDF
  </button>
</div>

</div>

<script>
const { jsPDF } = window.jspdf;
const sizes={A4:1,A3:2,A2:4};
let imgURL=null;

drop.onclick=()=>file.click();
file.onchange=e=>imgURL=URL.createObjectURL(e.target.files[0]);

async function exportPDF(){
  if(!imgURL) return alert("Add image");
  const scale=sizes[to.value]/sizes[from.value];
  const tiles=Math.sqrt(scale);
  const img=new Image(); img.src=imgURL; await img.decode();
  const pdf=new jsPDF({unit:"mm",format:from.value});

  for(let y=0;y<tiles;y++)for(let x=0;x<tiles;x++){
    const c=document.createElement("canvas");
    c.width=img.width/tiles; c.height=img.height/tiles;
    c.getContext("2d").drawImage(img,
      x*c.width,y*c.height,c.width,c.height,
      0,0,c.width,c.height);
    if(x||y) pdf.addPage();
    pdf.addImage(c.toDataURL(),"JPEG",0,0,
      pdf.internal.pageSize.getWidth(),pdf.internal.pageSize.getHeight());
  }
  window.open(pdf.output("bloburl"),"_blank");
}
</script>
</body>
</html>
